import { Asn1Reader } from '../src';
import {ASN1} from '@fidm/asn1';

const pkcs8_input = Buffer.from('3082025C02010002818100B44D2BA454F35F3ADA350E36EE1AC05DE6B15ABDE25E80EDE29BC95E65816A303950A3EA201AA5F50C88E89AA3500C9AC98BA21299F8F92C84AF276BCBFF3536856B2A665002DE00458C6EC2C04CC81C503B62762B85E756F3458213D0AAC1C7E898B39B3DFB44B40F319F4A8FA443455946CFB4B48227FA3FEB114AF9E35EC7020301000102818100967E2B45391B028BAF02C5E0979180AB6018FCF2AD75D00BBF2FE53E835F27F12485E8AB4D2CB104FEF76F9F535D4788135E17638B5D432E2379C75FB4A04A1AD6B7039BDF05AEC9098C4060907B008CF25DDE98CBE21965A5AF5AE82012314060C0F66956F4FE39F646C749160735600683361990277177C86E4E6571ABB521024100E392902571F78CE54B5C36B6CDCFD860C5028C99752A3460E98E497A915B8174DDAF8E5196A6E0093922A549B7ED535EF6626DEF445672C4174903A60574968F024100CAD2F29D7ACB80A8BFAA323D61B66DCCCEF21BB3AFA2381D66751294DF27A26731BA9A6F009081768599211BF3ABC3A8E495CB4CA611B2E00EF09FFED3CC904902404F9BDFCD19972DB4B0AE2B7DBB75B00DFA1D302E26AC82F23C01C876960EDAB495306AAAE3F6B07CC97DF3305CA52AFB1759CB775E0297D73D060FBEAE3DE0C502400FDD2C08D13FF5923D5B8C8E6C841E5674A14F3560B96976333B58F6B7F59BA842A57BCACEDA7EA5CC914B9BAA15773A5096BECE01F7446C6DFEB824F06001B10240154B4CF36EC357BDC58E2C1B9DBE14DDD82D88A3E9F5CA4D3E915E7C09603EF7CF922EFA4910984B5B75578386C7C721F8C46BDCBFD7EB3AFF9333561778A6B7', 'hex');

const reader = new Asn1Reader();
reader.on('data', (data: Buffer | ASN1) => {
    console.log("data => ", data);
});
reader.write(pkcs8_input);
